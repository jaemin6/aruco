import cv2
import cv2.aruco as aruco
import numpy as np
import os

# --- 설정 변수 ---
# 사용할 Aruco 딕셔너리 정의 (예: 4x4 크기에 50개의 고유 ID를 가진 딕셔너리)
# Aruco 공식 문서를 참고하여 프로젝트에 맞는 딕셔너리를 선택할 수 있습니다.
ARUCO_DICT = aruco.DICT_4X4_50

# 생성할 마커의 고유 ID (0에서 49 사이)
MARKER_ID = 25 

# 생성될 이미지의 픽셀 크기 (마커가 커질수록 인식률이 좋고 3D 좌표 오차가 줄어듭니다)
MARKER_SIZE_PIXELS = 700 

# 저장 경로
OUTPUT_DIR = "markers"

# --- 코드 실행 ---
if not os.path.exists(OUTPUT_DIR):
    os.makedirs(OUTPUT_DIR)

# 1. 딕셔너리 로드
aruco_dict = aruco.getPredefinedDictionary(ARUCO_DICT)

# 2. 마커 이미지 생성 (흰색 배경에 검은색 패턴)
# 1은 검은색, 0은 흰색이 되도록 numpy 배열을 만듭니다.
marker_image = aruco.generateImage(aruco_dict, MARKER_ID, MARKER_SIZE_PIXELS)

# 3. 이미지 저장
file_name = os.path.join(OUTPUT_DIR, f"aruco_id_{MARKER_ID}_{MARKER_SIZE_PIXELS}px.png")
cv2.imwrite(file_name, marker_image)

print(f"✅ Aruco 마커 (ID: {MARKER_ID})가 '{file_name}'로 저장되었습니다.")